2012-07-27  Nick Alcock  <nick.alcock@oracle.com>

	* GNUmakefile: Install libraries to lib64, not lib.

2012-07-25  Nick Alcock  <nick.alcock@oracle.com>

	* include/sys/ctf.h: Update CTF comment, adding variable
	info.
	(CTF_OLD_VERSIONS): Remove.
	(ctf_header_v1): Likewise.
	(CTF_*_V1): Likewise.
	(CTF_MAGIC): Change, this is no longer compatible with Solaris libctf.
	(CTF_VERSION_2): Delete.
	(CTF_VERSION): Update.
	(ctf_header): Add cth_varoff.
	(ctf_varent): New.
	* libctf/ctf_open.c (_CTF_SECTION): Change to .dtrace_ctf.
	(get_kind_v1): Remove.
	(get_root_v1): Likewise.
	(get_vlen_v1): Likewise.
	(get_kind_v2): Rename to...
	(get_kind): ... this.
	(get_root_v2): Rename to...
	(get_root): ... this.
	(get_vlen_v2): Rename to...
	(get_vlen)... this.
	(ctf_fileops): Adjust.
	(init_types): Remove v1 support, and support for pre-cth_parname
	containers.
	(ctf_bufopen): Verify varoff position and alignment.
	* libctf/ctf_labels.c (extract_label_info): Remove v1 support.
	* libctf/ctf_types.c (ctf_get_ctt_size): Likewise.
	(ctf_member_iter): Likewise.
	(ctf_type_align): Likewise.
	(ctf_member_info): Likewise.
	(ctf_type_rvisit): Likewise.
	libctf/Build (libdtrace-ctf_CPPFLAGS): Drop -D_CTF_OLD_VERSIONS.

	* README: Note that the file formats are incompatible now.

	* libctf/ctf_impl.h (ctf_dynparname): New ctf_file field.
	* libctf/ctf_open.c (ctf_parent_name_set): New function.
	* include/sys/ctf_api.h: Prototype it.
	* libctf/libdtrace-ctf.ver: Export it.
	* libctf/ctf_open.c (ctf_import): Call it with "PARENT" if no name
	is already set.
	(ctf_close): Free ctf_dynparname if set.
	* libctf/ctf_create.c (_CTF_STRTAB_TEMPLATE): Delete.
	(ctf_create): The dtstrlen no longer includes the size of the
	template.
	(ctf_update): If a parname is set, add it to the cth_strlen size.
	Always add a \0 as the first string table byte; copy in
	ctf_parname as the first strtab element if set.

2012-07-20  Nick Alcock  <nick.alcock@oracle.com>

	* libctf/ctf_hash.c (ctf_hash_create): Make this hash table bigger
	too.

2012-07-19  Nick Alcock  <nick.alcock@oracle.com>

	* libctf/ctf_create.c (ctf_create): Use a much bigger hash table.

2012-07-17  Nick Alcock  <nick.alcock@oracle.com>

	* libctf/ctf_error.c (_ctf_errlist): Synch with the error
	#defines.

	* include/sys/ctf.h (CTF_MAX_PTYPE): New, the maximum possible
	parent CTF type ID.

	* libctf/ctf_create.c (ctf_add_generic): Stop parent types from
	overflowing into the child type ID space.

	* .gitignore: New, ignore the build directory, editor backup
	files, and object files.

2012-07-16  Nick Alcock  <nick.alcock@oracle.com>

	* Makeconfig (CONFIG_H): Add missing path slash.
	* include/Build (install): Fix silent build output during
	header installation.

2012-06-18  Nick Alcock  <nick.alcock@oracle.com>

	Synch build system from DTrace.

	Add a crude symbol-checking infrastructure, like Autoconf's
	AC_CHECK_LIB.  Use it to check for elf_getshdrstrndx().

	* Makeconfig: New file.
	* GNUmakefile: Include it.  Search the objdir for generated header files.
	* Makefunctions: All C compilations depend on the config.h file.
	* README.build.system: Describe the new infrastructure briefly.

	* GNUmakefile: No longer specify 64-bitness of file I/O: it is
	redundant on x86-64 and breaks fts().

2012-05-18  Nick Alcock  <nick.alcock@oracle.com>

	Creation, split from dtrace and relicensed.
